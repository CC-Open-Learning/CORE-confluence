<!DOCTYPE html>
<html>
    <head>
        <title>CORE Framework : NodeCanvas and State Machine Analytics</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">CORE Framework</a></span>
                            </li>
                                                    <li>
                                <span><a href="CORE-Framework_495616264.html">CORE Framework</a></span>
                            </li>
                                                    <li>
                                <span><a href="Analytics-Service_707919890.html">Analytics Service</a></span>
                            </li>
                                                    <li>
                                <span><a href="Analytics-V1-Overview_1259077643.html">Analytics V1 Overview</a></span>
                            </li>
                                                    <li>
                                <span><a href="Existing-Implementation_782598172.html">Existing Implementation</a></span>
                            </li>
                                                    <li>
                                <span><a href="CORE-Sandbox_782499892.html">CORE Sandbox</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            CORE Framework : NodeCanvas and State Machine Analytics
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                            
        
    
        
    
        
        
            Created by <span class='author'> Hayden Auterhoff</span>, last modified on Aug 18, 2023
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <h1 id="NodeCanvasandStateMachineAnalytics-Contents">Contents</h1><style type='text/css'>/*<![CDATA[*/
div.rbtoc1748544194851 {padding: 0px;}
div.rbtoc1748544194851 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1748544194851 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1748544194851'>
<ul class='toc-indentation'>
<li><a href='#NodeCanvasandStateMachineAnalytics-Overview'>Overview</a></li>
<li><a href='#NodeCanvasandStateMachineAnalytics-NodeCanvasandStateMachineAnalyticTutorial/Example'>NodeCanvas and State Machine Analytic Tutorial / Example</a></li>
<li><a href='#NodeCanvasandStateMachineAnalytics-LoginLearner'>LoginLearner</a></li>
<li><a href='#NodeCanvasandStateMachineAnalytics-QuizComponents'>Quiz Components</a></li>
<li><a href='#NodeCanvasandStateMachineAnalytics-Summary'>Summary</a></li>
</ul>
</div><hr/><h2 id="NodeCanvasandStateMachineAnalytics-Overview">Overview</h2><div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p><strong><u>Attention</u></strong>: To successfully examine the CORE Sandbox implementation, the installation of PlayFab and the VARLab analytic package must have been completed. </p><p>If installation is not complete, refer here for more instructions: <a class="external-link" data-card-appearance="inline" href="https://varlab-dev.atlassian.net/l/cp/U7EyYxuJ" rel="nofollow">https://varlab-dev.atlassian.net/l/cp/U7EyYxuJ</a> </p></div></div><p>This page will provide a simple implementation of the analytics package and how to capture analytic events using NodeCanvas and a state machine in Unity. The following example assumes that the VARLab analytic package is installed on your Unity project and that you have installed and signed into the PlayFab SDK.</p><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p><u>Note</u>: in the PlayFab SDK select which game title you want to use, or you won’t be raising any events.</p></div></div><hr/><h2 id="NodeCanvasandStateMachineAnalytics-NodeCanvasandStateMachineAnalyticTutorial/Example">NodeCanvas and State Machine Analytic Tutorial / Example</h2><p>To find an example of the implementations of the analytic package using NodeCanvas and states, check out the VARLab CORE Sandbox Development Environment under the branch <a class="external-link" href="https://bitbucket.org/VARLab/core-sandbox-development-environment/src/CORE-89-Analytics-Tutorial-Updated-Package/" rel="nofollow"><u>CORE-89-Analytics-Tutorial-Updated-Package</u></a>.</p><p>Fork the repository to have a local version of the tutorial, and navigate to the scene called State Machine.</p><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" loading="lazy" src="attachments/756285493/760512513.png" data-image-src="attachments/756285493/760512513.png" data-height="96" data-width="197" data-unresolved-comment-count="0" data-linked-resource-id="760512513" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20230714-134842.png" data-base-url="https://varlab-dev.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="756285493" data-linked-resource-container-version="13" data-media-id="ca969aec-ca60-49c3-a3b1-a31015978d60" data-media-type="file"></span><p>All of the resources that are not in the analytic package will be found in the scene hierarchy and in the Scripts folder. The specific scripts used for this scene will be in the State Machine folder.</p><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" loading="lazy" src="attachments/756285493/760446988.png" data-image-src="attachments/756285493/760446988.png" data-height="99" data-width="374" data-unresolved-comment-count="0" data-linked-resource-id="760446988" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20230714-135123.png" data-base-url="https://varlab-dev.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="756285493" data-linked-resource-container-version="13" data-media-id="b572d514-2a86-44e8-abe9-7cc9875b97e5" data-media-type="file"></span><div class="panel" style="background-color: #EAE6FF;border-color: #998DD9;border-width: 1px;"><div class="panelContent" style="background-color: #EAE6FF;">
<p><u>Developer Note</u>: Scripts are coupled to Unity in this example</p><ul><li><p>More information can be found in the drop down below.</p></li></ul>
</div></div><div id="expander-1268825089" class="expand-container"><div id="expander-control-1268825089" class="expand-control"><span class="expand-control-icon"><img style="vertical-align:middle;" class="expand-control-image" src="images/icons/grey_arrow_down.png"></span><span class="expand-control-text">Functional Implementation with NodeCanvas</span></div><div id="expander-content-1268825089" class="expand-content"><p>The NodeCanvas and state machine analytic tutorial uses a functional approach to the logic and implementation with none of the Unity or VARLab Analytics decoupled from the scripts. If you want an example of interfaces and wrappers that decouple the implementation from Unity and VARLab Analytics, then check out the <a href="https://varlab-dev.atlassian.net/wiki/spaces/CV2/pages/756973572" rel="nofollow"><u>UI implementation</u></a>.</p></div></div><hr/><h2 id="NodeCanvasandStateMachineAnalytics-LoginLearner"><span class="inline-comment-marker" data-ref="4f75c5ba-57bd-422c-9e13-d5ae1768f989">LoginLearner</span></h2><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p><u>Note</u>: the analytic package provides a prefab of an Analytics gameObject, more information can be found <a href="https://varlab-dev.atlassian.net/wiki/spaces/CV2/pages/782565419/Setting+Up+Analytics#Analytics-Prefab" rel="nofollow"><u>here</u></a>: <a data-card-appearance="inline" href="https://varlab-dev.atlassian.net/wiki/spaces/CV2/pages/782565419/Setting+Up+Analytics#Analytics-Prefab" rel="nofollow">https://varlab-dev.atlassian.net/wiki/spaces/CV2/pages/782565419/Setting+Up+Analytics#Analytics-Prefab</a> </p><ul><li><p>The CORE Sandbox examples did not use this prefab, however the implementation is the same as the prefab. For an explanation of the black box implementation of the analytics prefab object, please refer to <a class="external-link" href="https://varlab-dev.atlassian.net/l/cp/sA2APfMY" rel="nofollow"><u>here</u></a>: <a class="external-link" data-card-appearance="inline" href="https://varlab-dev.atlassian.net/l/cp/dg1yshzm" rel="nofollow">https://varlab-dev.atlassian.net/l/cp/dg1yshzm</a> </p></li></ul></div></div><h3 id="NodeCanvasandStateMachineAnalytics-NodeCanvas">NodeCanvas</h3><p><span class="inline-comment-marker" data-ref="9cc18ba3-95c8-466d-a717-23fee7f7a5e7">In this example, the LoginLearner method from the analytic package will be handled by the NodeCanvas as the START action (Ex 1). The state of the system is set to ‘waiting’, but once a correct or incorrect button is selected, the state of the system changes to “Correct” or “Incorrect”, which invokes the SendEvent() method from QuizHandler.</span></p><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p><u><span class="inline-comment-marker" data-ref="9cc18ba3-95c8-466d-a717-23fee7f7a5e7">Note</span></u><span class="inline-comment-marker" data-ref="9cc18ba3-95c8-466d-a717-23fee7f7a5e7">: the ButtonClick functionality is a script that passes the Button component to the QuizHandler, so the script will be called twice. First with the ButtonClick that changes the state, then second with the NodeCanvas state changing to trigger the action item of invoking the SendEvent().</span></p></div></div><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" loading="lazy" src="attachments/756285493/759693461.png" data-image-src="attachments/756285493/759693461.png" data-height="367" data-width="654" data-unresolved-comment-count="0" data-linked-resource-id="759693461" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20230714-140953.png" data-base-url="https://varlab-dev.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="756285493" data-linked-resource-container-version="13" data-media-id="3d483481-02a2-4121-8720-fa1de4b72f9a" data-media-type="file"></span><p>The LoginLearner method only accepts a string as a parameter for the LearnerID, which in this tutorial is hard-coded in the START action of the NodeCanvas. Therefore, when the program is started, then the LoginLearner information will be sent to PlayFab during runtime. However, this can be implemented in a number of different ways depending on the design of the project.</p><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p><u>Note</u>: <span class="inline-comment-marker" data-ref="9cc18ba3-95c8-466d-a717-23fee7f7a5e7">The LoginLearner method is the only method that relies on the CORE Analytics class from the analytics package but will still need to be added onto a gameObject due to the mono behaviour.</span></p></div></div><div class="panel" style="background-color: #EAE6FF;border-color: #998DD9;border-width: 1px;"><div class="panelContent" style="background-color: #EAE6FF;">
<p><u>Developer Note</u>: LoginHandler needs to be on a gameObject</p><ul><li><p>More information can be found in the drop down below.</p></li></ul>
</div></div><div id="expander-642513281" class="expand-container"><div id="expander-control-642513281" class="expand-control"><span class="expand-control-icon"><img style="vertical-align:middle;" class="expand-control-image" src="images/icons/grey_arrow_down.png"></span><span class="expand-control-text">LoginHandler</span></div><div id="expander-content-642513281" class="expand-content"><p>The LoginLearner method can be applied to any script but does need to be attached to a gameObject since the COREAnalytics class from the analytic package is a mono behaviour. </p><p>In addition, the logic used for determining the information passed to the LoginLearner method depends on the design of the project. The LoginLearner might be a user input or might need an API call from SCORM to get the LearnerID.</p></div></div><hr/><h2 id="NodeCanvasandStateMachineAnalytics-QuizComponents">Quiz Components</h2><p>The quiz component uses the scriptable object called the Analytics Channel. More information can be found by navigating to the “Sending Default Events” section on the page: <a class="external-link" data-card-appearance="inline" href="https://varlab-dev.atlassian.net/l/cp/kyEdsk6X" rel="nofollow">https://varlab-dev.atlassian.net/l/cp/kyEdsk6X</a></p><h3 id="NodeCanvasandStateMachineAnalytics-QuizAnswerScript"><u>QuizAnswer Script</u></h3><p>With the use of the Analytics Channel, information can be collected and stored in objects. In this example, the quiz component for the correct or incorrect button is a gameObject with the defined quiz properties:</p><ul><li><p>isCorrect</p></li><li><p>QuestionName</p></li><li><p>SectionNumber</p></li></ul><p><span class="inline-comment-marker" data-ref="4a64325e-479c-40a1-860c-93698133180a">The components of a quiz object are defined in the editor with the QUiz Answer script (Ex. 2), then extracted in the QuizHandler script to determine if the button object has a quiz component.</span></p><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" loading="lazy" src="attachments/756285493/760774657.png" data-image-src="attachments/756285493/760774657.png" data-height="260" data-width="1022" data-unresolved-comment-count="0" data-linked-resource-id="760774657" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20230714-142407.png" data-base-url="https://varlab-dev.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="756285493" data-linked-resource-container-version="13" data-media-id="6724af0a-7629-4098-8d2c-c628cf6ac7f9" data-media-type="file"></span><h3 id="NodeCanvasandStateMachineAnalytics-QuizHandlerScript"><u>QuizHandler Script</u></h3><p>The QuizHandler script is attached to the Canvas gameObject and will need the Analytics Event class from the analytics package. The Analytics Event is the same scriptable object from earlier. The Quiz Handler has three serialized components (Ex. 3):</p><ul><li><p>Quiz Answer</p></li><li><p>Analytics Event</p></li><li><p>State Manager</p></li></ul><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" loading="lazy" src="attachments/756285493/760807425.png" data-image-src="attachments/756285493/760807425.png" data-height="388" data-width="1022" data-unresolved-comment-count="0" data-linked-resource-id="760807425" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20230714-142605.png" data-base-url="https://varlab-dev.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="756285493" data-linked-resource-container-version="13" data-media-id="be6e548c-55e2-4955-9c2e-2d8739218324" data-media-type="file"></span><p>The Quiz Answer is left unserialized as this will be populated by the Component of the Button gameObject passed to the script when the button is clicked by the user. The Quiz Complete is the class that handles the DLXComplete analytic event. Based on the logic of the tutorial with the state of the system, a user cannot submit (or complete) the program without selecting an option on the quiz.</p><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" loading="lazy" src="attachments/756285493/760709123.png" data-image-src="attachments/756285493/760709123.png" data-height="289" data-width="546" data-unresolved-comment-count="0" data-linked-resource-id="760709123" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20230714-143205.png" data-base-url="https://varlab-dev.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="756285493" data-linked-resource-container-version="13" data-media-id="5e08713a-3e00-4a8a-a4ec-861297c0f66c" data-media-type="file"></span><p>When the QuizHandler is passed a button gameObject with a component of QuizAnswer, then the state of the system will be changed based on the properties of the button. Once the state is changed, NodeCanvas triggers the condition to start an action. </p><p>In the case of selecting ‘Correct’ or ‘Incorrect’, the change to one of these states will invoke the SendEvent() method from the QuizHandler. SendEvent() will raise a ProgressEvent to PlayFab using the components of the QuizAnswer.</p><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p><u><span class="inline-comment-marker" data-ref="c4019e38-0f2c-4051-a628-233c811265d9">Note</span></u>: Quiz segments were not implemented in this tutorial, if you want to see an example of the SegmentCompleteContainer being used, then check out <a href="UI-Analytics_756973572.html" data-linked-resource-id="756973572" data-linked-resource-version="23" data-linked-resource-type="page"><u>UI Analytics</u></a> or <a href="Interactable-Analytics_756383762.html" data-linked-resource-id="756383762" data-linked-resource-version="17" data-linked-resource-type="page"><u>Interactable Analytics</u></a><u>.</u></p></div></div><h3 id="NodeCanvasandStateMachineAnalytics-QuizCompleteScript"><u>QuizComplete Script</u></h3><p>In the case of selecting ‘Submit’, the change to the ‘Complete’ state will only occur if the system is in the state of ‘Correct’ or ‘Incorrect’. However, if the system state is changed, then the isDLXComplete() method from the QuizComplete class will raise a DLXCompleteEvent to PlayFab. The QuizComplete script has an Analytic Event as a serialized component (Ex. 4) and will need to be part of a gameObject due to the mono behaviour of the Analytic Event class.</p><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" loading="lazy" src="attachments/756285493/760807431.png" data-image-src="attachments/756285493/760807431.png" data-height="388" data-width="1022" data-unresolved-comment-count="0" data-linked-resource-id="760807431" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20230714-144415.png" data-base-url="https://varlab-dev.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="756285493" data-linked-resource-container-version="13" data-media-id="b7ab451f-532b-43c7-b4b0-1733dd687c0c" data-media-type="file"></span><div class="panel" style="background-color: #EAE6FF;border-color: #998DD9;border-width: 1px;"><div class="panelContent" style="background-color: #EAE6FF;">
<p><u>Developer Note</u>: QuizHandler and QuizComplete need to be on a gameObject</p><ul><li><p>More information can be found in the drop down below.</p></li></ul>
</div></div><div id="expander-2036648162" class="expand-container"><div id="expander-control-2036648162" class="expand-control"><span class="expand-control-icon"><img style="vertical-align:middle;" class="expand-control-image" src="images/icons/grey_arrow_down.png"></span><span class="expand-control-text">QuizHandler and QuizComplete</span></div><div id="expander-content-2036648162" class="expand-content"><p>The implementation of analytics using NodeCanvas and the state machine is a simple example of ‘how’ analytics can be used in a Unity project. The Quiz Handler and Quiz Complete script can be placed on any <span class="inline-comment-marker" data-ref="f9bc3257-5515-4933-9345-151d843a1ccf">gameObject</span> but does need to be on a gameObject since the analytic events class from the analytics package is a mono behaviour.</p><p>In addition, the logic used for determining when and how a segment is completed is based on the design of the Unity project. The tutorial is really meant to show how to raise these analytic events in a Unity project.</p></div></div><hr/><h2 id="NodeCanvasandStateMachineAnalytics-Summary">Summary</h2><p>These analytic tutorials are a tool to help provide a framework or guideline of how to use the CORE analytics and analytic events from the analytic package. The implementation is a general use case but hopes to be beneficial in understanding and easy to reverse engineer.</p><p>In the implementation of analytics using NodeCanvas and the state machine, there is a functional approach to the logic and implementation with none of the Unity or VARLab Analytics decoupled from the scripts. The <a href="UI-Analytics_756973572.html" data-linked-resource-id="756973572" data-linked-resource-version="23" data-linked-resource-type="page"><u>UI Implementation</u></a> provides an example of using interfaces and wrappers to reduce the dependency on these namespaces to provide easier unit testing options. If you need an example of the implementation with interfaces and wrappers, then please refer to this example.</p>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/756285493/760512513.png">image-20230714-134842.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/756285493/760446988.png">image-20230714-135123.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/756285493/759693455.png">image-20230714-135650.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/756285493/760610817.png">image-20230714-140058.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/756285493/760446994.png">image-20230714-140414.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/756285493/759693461.png">image-20230714-140953.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/756285493/760774657.png">image-20230714-142407.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/756285493/760807425.png">image-20230714-142605.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/756285493/760709123.png">image-20230714-143205.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/756285493/760807431.png">image-20230714-144415.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/756285493/760774672.png">image-20230714-011721.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/756285493/760053916.png">image-20230714-180425.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on May 29, 2025 18:43</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
